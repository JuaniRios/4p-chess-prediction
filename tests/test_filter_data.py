import pytest
import os
from data_cleaning.filter_data import filter_data


@pytest.fixture
def sample_game_sol():
    game = """[GameNr "626072"][Variant "FFA"][RuleVariants "PromoteTo=D"][Result "uuyytee: 5 - george56789: 83 - papabellotas2: 6 - kuprabhu: 62"][Termination "Game over. (Blue +20)"][Red "uuyytee"][RedElo "1892"][Blue "george56789"][BlueElo "1928"][Yellow "papabellotas2"][YellowElo "1886"][Green "kuprabhu"][GreenElo "1881"][TimeControl "1+15D"][Site "www.chess.com/4-player-chess"][Date "Mon Dec 17 2018 18:40:52 GMT+0000 (UTC)"]1. d2-d4 { date=2018-12-17T18:20:15.602Z clock=60000 }  .. b7-d7 { date=2018-12-17T18:20:18.568Z clock=60000 }  .. j13-j12 { date=2018-12-17T18:20:22.737Z clock=60000 }  .. m8-k8 { date=2018-12-17T18:20:27.752Z clock=60000 } 2. Ne1-f3 { date=2018-12-17T18:20:32.810Z clock=60000 }  .. d7-e7 { date=2018-12-17T18:20:35.326Z clock=60000 }  .. Bi14-j13 { date=2018-12-17T18:20:36.718Z clock=60000 }  .. k8-j8 { date=2018-12-17T18:20:39.332Z clock=60000 } 3. e2-e3 { date=2018-12-17T18:20:41.072Z clock=60000 }  .. b6-c6 { date=2018-12-17T18:20:43.289Z clock=60000 }  .. g13-g11 { date=2018-12-17T18:20:46.540Z clock=60000 }  .. j8-i8 { date=2018-12-17T18:20:48.737Z clock=60000 } 4. Nj1-i3 { date=2018-12-17T18:20:51.953Z clock=60000 }  .. e7-f7 { date=2018-12-17T18:20:53.255Z clock=60000 }  .. Nj14-i12 { date=2018-12-17T18:20:54.603Z clock=60000 }  .. i8-h8 { date=2018-12-17T18:20:55.736Z clock=60000 } 5. Ni3-h5 { date=2018-12-17T18:21:02.073Z clock=60000 }  .. Na10-c9 { date=2018-12-17T18:21:06.560Z clock=60000 }  .. d13-d12 { date=2018-12-17T18:21:12.666Z clock=60000 }  .. m5-l5 { date=2018-12-17T18:21:22.582Z clock=60000 } 6. k2-k3 { date=2018-12-17T18:21:26.792Z clock=60000 }  .. b10-c10 { date=2018-12-17T18:21:29.475Z clock=60000 }  .. Ne14-f12 { date=2018-12-17T18:21:31.852Z clock=60000 }  .. Bn6-m5 { date=2018-12-17T18:21:34.857Z clock=60000 } 7. Bf1-e2 { date=2018-12-17T18:21:40.046Z clock=60000 }  .. Ba9-b10 { date=2018-12-17T18:21:43.477Z clock=60000 }  .. Bf14-h12 { date=2018-12-17T18:21:47.167Z clock=60000 }  .. Nn5-l6 { date=2018-12-17T18:21:48.857Z clock=60000 } 8. h2-h3 { date=2018-12-17T18:21:58.022Z clock=60000 }  .. O-O { date=2018-12-17T18:22:00.714Z clock=60000 }  .. Qh14-g13 { date=2018-12-17T18:22:02.486Z clock=60000 }  .. Nn10-l9 { date=2018-12-17T18:22:10.062Z clock=60000 } 9. Qg1-h2 { date=2018-12-17T18:22:20.874Z clock=60000 }  .. Ra9-a8 { date=2018-12-17T18:22:23.517Z clock=60000 }  .. O-O-O { date=2018-12-17T18:22:26.425Z clock=60000 }  .. O-O { date=2018-12-17T18:22:28.882Z clock=60000 } 10. O-O-O { date=2018-12-17T18:22:35.075Z clock=60000 }  .. b8-c8 { date=2018-12-17T18:22:36.969Z clock=60000 }  .. Ki14-j14 { date=2018-12-17T18:22:40.204Z clock=60000 }  .. Qn8-k8 { date=2018-12-17T18:22:44.676Z clock=60000 } 11. Nf3-d2 { date=2018-12-17T18:22:50.389Z clock=60000 }  .. b5-c5 { date=2018-12-17T18:22:58.275Z clock=60000 }  .. Ni12-j10 { date=2018-12-17T18:22:59.841Z clock=60000 }  .. Nl9xNj10 { date=2018-12-17T18:23:03.972Z clock=60000 } 12. Be2xBa6 { date=2018-12-17T18:23:20.765Z clock=58207 }  .. Qa7xBa6+ { date=2018-12-17T18:23:24.120Z clock=60000 }  .. Bh12xNj10 { date=2018-12-17T18:23:25.128Z clock=60000 }  .. Qk8xNh5 { date=2018-12-17T18:23:30.787Z clock=60000 } 13. Nd2-c4 { date=2018-12-17T18:23:52.764Z clock=51230 }  .. Qa6xNc4+ { date=2018-12-17T18:23:55.497Z clock=60000 }  .. Bj10xm7 { date=2018-12-17T18:23:57.323Z clock=60000 }  .. Qh5-d1+# { date=2018-12-17T18:23:59.802Z clock=60000 } 14. Qc4-a6 { date=2018-12-17T18:24:08.237Z clock=60000 }  .. h13-h11 { date=2018-12-17T18:24:12.462Z clock=60000 }  .. Rn6-n7 { date=2018-12-17T18:24:17.357Z clock=60000 } 15. Qa6-a7 { date=2018-12-17T18:24:21.749Z clock=60000 }  .. Bm7-j10 { date=2018-12-17T18:24:24.482Z clock=60000 }  .. Qd1-k8 { date=2018-12-17T18:24:30.787Z clock=60000 } 16. f7-g7 { date=2018-12-17T18:24:37.119Z clock=60000 }  .. k13-k11 { date=2018-12-17T18:24:39.374Z clock=60000 }  .. h8-g8=Q { date=2018-12-17T18:24:41.437Z clock=60000 } 17. g7-h7=Q { date=2018-12-17T18:24:42.899Z clock=60000 }  .. g11-g10 { date=2018-12-17T18:24:57.128Z clock=60000 }  .. Bn9-l7 { date=2018-12-17T18:25:13.367Z clock=58761 } 18. Qh7-c7 { date=2018-12-17T18:25:20.959Z clock=60000 }  .. h11-h10 { date=2018-12-17T18:25:25.990Z clock=60000 }  .. m11-l11 { date=2018-12-17T18:25:28.637Z clock=58761 } 19. Na5-b7 { date=2018-12-17T18:25:34.758Z clock=60000 }  .. h10-h9 { date=2018-12-17T18:25:36.084Z clock=60000 }  .. Qg8-j8 { date=2018-12-17T18:25:47.011Z clock=58761 } 20. c6-d6 { date=2018-12-17T18:25:51.190Z clock=60000 }  .. g10-g9 { date=2018-12-17T18:25:53.808Z clock=60000 }  .. m9-k9 { date=2018-12-17T18:25:58.272Z clock=58761 } 21. d6-e6 { date=2018-12-17T18:26:08.791Z clock=60000 }  .. Bj10-i11 { date=2018-12-17T18:26:16.309Z clock=60000 }  .. m10-k10 { date=2018-12-17T18:26:25.936Z clock=58761 } 22. e6-f6 { date=2018-12-17T18:26:35.551Z clock=60000 }  .. Bi11xk9 { date=2018-12-17T18:26:36.587Z clock=60000 }  .. Qj8-j9 { date=2018-12-17T18:26:54.787Z clock=55561 } 23. f6-g6 { date=2018-12-17T18:26:57.906Z clock=60000 }  .. Bk9-j10 { date=2018-12-17T18:27:00.366Z clock=60000 }  .. Qj9xBj10 { date=2018-12-17T18:27:13.527Z clock=55561 } 24. g6-h6=Q { date=2018-12-17T18:27:20.220Z clock=60000 }  .. Qg13xQj10 { date=2018-12-17T18:27:36.192Z clock=59028 }  .. Qk8xf13 { date=2018-12-17T18:27:39.112Z clock=55561 } 25. Qc7xi13+ { date=2018-12-17T18:27:45.158Z clock=60000 }  .. Kj14-k13 { date=2018-12-17T18:27:48.672Z clock=59028 }  .. Qf13xe13 { date=2018-12-17T18:27:56.431Z clock=55561 } 26. Qi13xBj13+# { date=2018-12-17T18:27:58.587Z clock=60000 }  .. Qe13xQj13 { date=2018-12-17T18:28:05.007Z clock=55561 } 27. c5-d5 { date=2018-12-17T18:28:10.159Z clock=60000 }  .. Qj13xj12 { date=2018-12-17T18:28:16.641Z clock=55561 } 28. d5-e5 { date=2018-12-17T18:28:18.465Z clock=60000 }  .. Qj12xQj10 { date=2018-12-17T18:28:20.221Z clock=55561 } 29. e5-f5 { date=2018-12-17T18:28:22.939Z clock=60000 }  .. Nl6-j5 { date=2018-12-17T18:28:24.818Z clock=55561 } 30. Qh6-g6 { date=2018-12-17T18:28:31.461Z clock=60000 }  .. Bl7-j9 { date=2018-12-17T18:28:38.312Z clock=55561 } 31. Qg6-e6 { date=2018-12-17T18:28:44.955Z clock=60000 }  .. Qj10-k9 { date=2018-12-17T18:28:54.286Z clock=55561 } 32. b11-d11 { date=2018-12-17T18:29:01.774Z clock=60000 }  .. Rn7-g7 { date=2018-12-17T18:29:06.612Z clock=55561 } 33. Qa7-a6 { date=2018-12-17T18:29:11.563Z clock=60000 }  .. Rn11-n6 { date=2018-12-17T18:29:14.657Z clock=55561 } 34. Nc9-e8 { date=2018-12-17T18:29:18.587Z clock=60000 }  .. Rg7xg2 { date=2018-12-17T18:29:23.487Z clock=55561 } 35. Nb7-c9 { date=2018-12-17T18:29:26.220Z clock=60000 }  .. Rg2-g5 { date=2018-12-17T18:29:28.202Z clock=55561 } 36. Ra4-a5 { date=2018-12-17T18:29:34.507Z clock=60000 }  .. Nj5-h6 { date=2018-12-17T18:29:38.827Z clock=55561 } 37. Ne8-d6 { date=2018-12-17T18:29:48.711Z clock=60000 }  .. Nh6xf5 { date=2018-12-17T18:29:51.896Z clock=55561 } 38. Nd6xNf5 { date=2018-12-17T18:29:54.573Z clock=60000 }  .. Qk9-l10 { date=2018-12-17T18:30:07.377Z clock=55561 } 39. Nf5xd4 { date=2018-12-17T18:30:11.219Z clock=60000 }  .. Rg5xRa5 { date=2018-12-17T18:30:15.072Z clock=55561 } 40. Qa6xRa5 { date=2018-12-17T18:30:17.518Z clock=60000 }  .. Ql10xk11 { date=2018-12-17T18:30:18.422Z clock=55561 } 41. Nd4-c6 { date=2018-12-17T18:30:21.896Z clock=60000 }  .. Qk11-i9 { date=2018-12-17T18:30:28.727Z clock=55561 } 42. Qe6-e5 { date=2018-12-17T18:30:33.404Z clock=60000 }  .. Qi9-i8 { date=2018-12-17T18:30:37.042Z clock=55561 } 43. b4-d4 { date=2018-12-17T18:30:40.427Z clock=60000 }  .. Qi8-i12 { date=2018-12-17T18:30:42.626Z clock=55561 } 44. Nc6-b8 { date=2018-12-17T18:30:45.235Z clock=60000 }  .. l11-k11 { date=2018-12-17T18:30:49.311Z clock=55561 } 45. Qe5xk11 { date=2018-12-17T18:30:55.741Z clock=60000 }  .. Bm5-i9 { date=2018-12-17T18:31:09.042Z clock=55561 } 46. Qk11-j12 { date=2018-12-17T18:31:16.078Z clock=60000 }  .. Qi12xQj12 { date=2018-12-17T18:31:24.366Z clock=55561 } 47. d4-e4 { date=2018-12-17T18:31:32.679Z clock=60000 }  .. Bj9xe4 { date=2018-12-17T18:31:37.387Z clock=55561 } 48. Ra8-a6 { date=2018-12-17T18:31:48.572Z clock=60000 }  .. k10-j10 { date=2018-12-17T18:32:10.473Z clock=48660 } 49. Nc9-e10 { date=2018-12-17T18:32:27.011Z clock=58462 }  .. j10-i10 { date=2018-12-17T18:32:35.037Z clock=48660 } 50. Qa5-f10 { date=2018-12-17T18:32:40.079Z clock=58462 }  .. i10-h10 { date=2018-12-17T18:32:43.168Z clock=48660 } 51. Nb8-d9 { date=2018-12-17T18:32:48.680Z clock=58462 }  .. Rn6-n10 { date=2018-12-17T18:32:59.592Z clock=48660 } 52. Nd9-e11 { date=2018-12-17T18:33:03.606Z clock=58462 }  .. Bi9-h8 { date=2018-12-17T18:33:11.712Z clock=48660 } 53. Bb10-e7 { date=2018-12-17T18:33:16.606Z clock=58462 }  .. Be4-h7 { date=2018-12-17T18:33:24.010Z clock=48660 } 54. Ra6-h6 { date=2018-12-17T18:33:27.634Z clock=58462 }  .. Bh7xNe10 { date=2018-12-17T18:33:36.467Z clock=48660 } 55. Rh6xBh8 { date=2018-12-17T18:33:39.966Z clock=58462 }  .. Be10-i14 { date=2018-12-17T18:33:51.082Z clock=48660 } 56. Rh8-d8 { date=2018-12-17T18:34:08.536Z clock=56008 }  .. Bi14-j13 { date=2018-12-17T18:34:15.487Z clock=48660 } 57. Rd8-h8 { date=2018-12-17T18:34:28.258Z clock=56008 }  .. h10-g10=Q { date=2018-12-17T18:34:34.838Z clock=48660 } 58. Ne11xQg10 { date=2018-12-17T18:34:37.318Z clock=56008 }  .. Rn10xNg10 { date=2018-12-17T18:34:39.471Z clock=48660 } 59. Qf10-d8 { date=2018-12-17T18:34:44.767Z clock=56008 }  .. Rg10-n10 { date=2018-12-17T18:34:55.746Z clock=48660 } 60. Qd8-c9 { date=2018-12-17T18:35:10.785Z clock=55969 }  .. Rn10-n6 { date=2018-12-17T18:35:17.792Z clock=48660 } 61. c8-d8 { date=2018-12-17T18:35:21.959Z clock=55969 }  .. Qj12-j6 { date=2018-12-17T18:35:25.463Z clock=48660 } 62. Be7xg9 { date=2018-12-17T18:35:28.872Z clock=55969 }  .. Qj6-a6+ { date=2018-12-17T18:35:31.662Z clock=48660 } 63. Ka10-b10 { date=2018-12-17T18:35:34.386Z clock=55969 }  .. Bj13-n9 { date=2018-12-17T18:35:42.732Z clock=48660 } 64. d8-e8 { date=2018-12-17T18:35:45.803Z clock=55969 }  .. Qa6-g6 { date=2018-12-17T18:35:52.447Z clock=48660 } 65. e8-f8 { date=2018-12-17T18:35:58.315Z clock=55969 }  .. Bn9-j5 { date=2018-12-17T18:36:01.428Z clock=48660 } 66. d11-e11 { date=2018-12-17T18:36:26.433Z clock=45964 }  .. Bj5-g8 { date=2018-12-17T18:36:32.037Z clock=48660 } 67. e11-f11 { date=2018-12-17T18:36:43.017Z clock=45964 }  .. Rn6-n11 { date=2018-12-17T18:36:45.372Z clock=48660 } 68. Bg9-h10 { date=2018-12-17T18:37:08.972Z clock=37364 }  .. m4-k4 { date=2018-12-17T18:37:32.312Z clock=40320 } 69. f11-g11 { date=2018-12-17T18:37:35.020Z clock=37364 }  .. Qg6-f7 { date=2018-12-17T18:37:48.607Z clock=40320 } 70. Rh8-i8 { date=2018-12-17T18:38:28.352Z clock=12619 }  .. Bg8-h7 { date=2018-12-17T18:38:39.637Z clock=40320 } 71. Ri8-i11 { date=2018-12-17T18:38:42.429Z clock=12619 }  .. Rn11xRi11 { date=2018-12-17T18:39:02.446Z clock=35303 } 72. Bh10xRi11 { date=2018-12-17T18:39:04.480Z clock=12619 }  .. Bh7-j9 { date=2018-12-17T18:39:10.442Z clock=35303 } 73. Bi11-h10 { date=2018-12-17T18:39:18.165Z clock=12619 }  .. Bj9-l7 { date=2018-12-17T18:39:23.182Z clock=35303 } 74. Qc9-c8 { date=2018-12-17T18:39:29.540Z clock=12619 }  .. Qf7-g8 { date=2018-12-17T18:39:31.097Z clock=35303 } 75. Qc8-c9 { date=2018-12-17T18:39:34.030Z clock=12619 }  .. k4-j4 { date=2018-12-17T18:39:36.183Z clock=35303 } 76. Qc9-g9 { date=2018-12-17T18:39:38.745Z clock=12619 }  .. Qg8xQg9 { date=2018-12-17T18:40:09.717Z clock=19332 } 77. Bh10xQg9 { date=2018-12-17T18:40:15.663Z clock=12619 }  .. j4-i4 { date=2018-12-17T18:40:18.937Z clock=19332 } 78. f8-g8 { date=2018-12-17T18:40:20.893Z clock=12619 }  .. i4xh3 { date=2018-12-17T18:40:26.787Z clock=19332 } 79. Bg9-d6 { date=2018-12-17T18:40:32.786Z clock=12619 }  .. m6-k6 { date=2018-12-17T18:40:45.962Z clock=19332 } 80. g8-h8=Q { date=2018-12-17T18:40:47.586Z clock=12619 }  .. R { date=2018-12-17T18:40:52.293Z clock=19332 } """

    sol = {'GameNr': '626072', 'Variant': 'FFA', 'RuleVariants': 'PromoteTo=D', 'Result': 'uuyytee: 5 - george56789: 83 - papabellotas2: 6 - kuprabhu: 62', 'Termination': 'Game over. (Blue +20)',
           'Red': 'uuyytee', 'RedElo': '1892', 'Blue': 'george56789', 'BlueElo': '1928', 'Yellow': 'papabellotas2', 'YellowElo': '1886', 'Green': 'kuprabhu', 'GreenElo': '1881',
           'TimeControl': '1+15D', 'Site': 'www.chess.com/4-player-chess', 'Date': 'Mon Dec 17 2018 18:40:52 GMT+0000 (UTC)',
           'Rounds': [{'Moves': ['d2-d4', 'b7-d7', 'j13-j12', 'm8-k8'], 'Times': [0, 3, 4, 5], 'Number': 1}, {'Moves': ['Ne1-f3', 'd7-e7', 'Bi14-j13', 'k8-j8'], 'Times': [17, 3, 1, 3], 'Number': 2},
                      {'Moves': ['e2-e3', 'b6-c6', 'g13-g11', 'j8-i8'], 'Times': [26, 2, 3, 2], 'Number': 3}, {'Moves': ['Nj1-i3', 'e7-f7', 'Nj14-i12', 'i8-h8'], 'Times': [36, 2, 1, 1], 'Number': 4},
                      {'Moves': ['Ni3-h5', 'Na10-c9', 'd13-d12', 'm5-l5'], 'Times': [47, 4, 6, 10], 'Number': 5},
                      {'Moves': ['k2-k3', 'b10-c10', 'Ne14-f12', 'Bn6-m5'], 'Times': [71, 3, 2, 3], 'Number': 6},
                      {'Moves': ['Bf1-e2', 'Ba9-b10', 'Bf14-h12', 'Nn5-l6'], 'Times': [85, 3, 4, 1], 'Number': 7},
                      {'Moves': ['h2-h3', 'O-O', 'Qh14-g13', 'Nn10-l9'], 'Times': [103, 2, 2, 8], 'Number': 8}, {'Moves': ['Qg1-h2', 'Ra9-a8', 'O-O-O', 'O-O'], 'Times': [125, 3, 3, 2], 'Number': 9},
                      {'Moves': ['O-O-O', 'b8-c8', 'Ki14-j14', 'Qn8-k8'], 'Times': [140, 1, 4, 4], 'Number': 10},
                      {'Moves': ['Nf3-d2', 'b5-c5', 'Ni12-j10', 'Nl9xNj10'], 'Times': [155, 8, 1, 4], 'Number': 11},
                      {'Moves': ['Be2xBa6', 'Qa7xBa6+', 'Bh12xNj10', 'Qk8xNh5'], 'Times': [185, 4, 1, 5], 'Number': 12},
                      {'Moves': ['Nd2-c4', 'Qa6xNc4+', 'Bj10xm7', 'Qh5-d1+#'], 'Times': [217, 3, 2, 2], 'Number': 13}, {'Moves': ['Qc4-a6', 'h13-h11', 'Rn6-n7'], 'Times': [233, 4, 5], 'Number': 14},
                      {'Moves': ['Qa6-a7', 'Bm7-j10', 'Qd1-k8'], 'Times': [246, 3, 6], 'Number': 15}, {'Moves': ['f7-g7', 'k13-k11', 'h8-g8=Q'], 'Times': [262, 2, 2], 'Number': 16},
                      {'Moves': ['g7-h7=Q', 'g11-g10', 'Bn9-l7'], 'Times': [267, 15, 16], 'Number': 17}, {'Moves': ['Qh7-c7', 'h11-h10', 'm11-l11'], 'Times': [305, 5, 3], 'Number': 18},
                      {'Moves': ['Na5-b7', 'h10-h9', 'Qg8-j8'], 'Times': [319, 2, 11], 'Number': 19}, {'Moves': ['c6-d6', 'g10-g9', 'm9-k9'], 'Times': [336, 2, 5], 'Number': 20},
                      {'Moves': ['d6-e6', 'Bj10-i11', 'm10-k10'], 'Times': [353, 8, 9], 'Number': 21}, {'Moves': ['e6-f6', 'Bi11xk9', 'Qj8-j9'], 'Times': [380, 1, 18], 'Number': 22},
                      {'Moves': ['f6-g6', 'Bk9-j10', 'Qj9xBj10'], 'Times': [402, 3, 13], 'Number': 23}, {'Moves': ['g6-h6=Q', 'Qg13xQj10', 'Qk8xf13'], 'Times': [425, 16, 3], 'Number': 24},
                      {'Moves': ['Qc7xi13+', 'Kj14-k13', 'Qf13xe13'], 'Times': [450, 3, 8], 'Number': 25}, {'Moves': ['Qi13xBj13+#', 'Qe13xQj13'], 'Times': [463, 7], 'Number': 26},
                      {'Moves': ['c5-d5', 'Qj13xj12'], 'Times': [475, 6], 'Number': 27}, {'Moves': ['d5-e5', 'Qj12xQj10'], 'Times': [483, 2], 'Number': 28},
                      {'Moves': ['e5-f5', 'Nl6-j5'], 'Times': [487, 2], 'Number': 29}, {'Moves': ['Qh6-g6', 'Bl7-j9'], 'Times': [496, 7], 'Number': 30},
                      {'Moves': ['Qg6-e6', 'Qj10-k9'], 'Times': [509, 10], 'Number': 31}, {'Moves': ['b11-d11', 'Rn7-g7'], 'Times': [526, 5], 'Number': 32},
                      {'Moves': ['Qa7-a6', 'Rn11-n6'], 'Times': [536, 3], 'Number': 33}, {'Moves': ['Nc9-e8', 'Rg7xg2'], 'Times': [543, 5], 'Number': 34},
                      {'Moves': ['Nb7-c9', 'Rg2-g5'], 'Times': [551, 2], 'Number': 35}, {'Moves': ['Ra4-a5', 'Nj5-h6'], 'Times': [559, 4], 'Number': 36},
                      {'Moves': ['Ne8-d6', 'Nh6xf5'], 'Times': [573, 3], 'Number': 37}, {'Moves': ['Nd6xNf5', 'Qk9-l10'], 'Times': [579, 13], 'Number': 38},
                      {'Moves': ['Nf5xd4', 'Rg5xRa5'], 'Times': [596, 4], 'Number': 39}, {'Moves': ['Qa6xRa5', 'Ql10xk11'], 'Times': [602, 1], 'Number': 40},
                      {'Moves': ['Nd4-c6', 'Qk11-i9'], 'Times': [606, 7], 'Number': 41}, {'Moves': ['Qe6-e5', 'Qi9-i8'], 'Times': [618, 4], 'Number': 42},
                      {'Moves': ['b4-d4', 'Qi8-i12'], 'Times': [625, 2], 'Number': 43}, {'Moves': ['Nc6-b8', 'l11-k11'], 'Times': [630, 4], 'Number': 44},
                      {'Moves': ['Qe5xk11', 'Bm5-i9'], 'Times': [640, 14], 'Number': 45}, {'Moves': ['Qk11-j12', 'Qi12xQj12'], 'Times': [661, 8], 'Number': 46},
                      {'Moves': ['d4-e4', 'Bj9xe4'], 'Times': [677, 5], 'Number': 47}, {'Moves': ['Ra8-a6', 'k10-j10'], 'Times': [693, 22], 'Number': 48},
                      {'Moves': ['Nc9-e10', 'j10-i10'], 'Times': [732, 8], 'Number': 49}, {'Moves': ['Qa5-f10', 'i10-h10'], 'Times': [745, 3], 'Number': 50},
                      {'Moves': ['Nb8-d9', 'Rn6-n10'], 'Times': [753, 11], 'Number': 51}, {'Moves': ['Nd9-e11', 'Bi9-h8'], 'Times': [768, 8], 'Number': 52},
                      {'Moves': ['Bb10-e7', 'Be4-h7'], 'Times': [781, 8], 'Number': 53}, {'Moves': ['Ra6-h6', 'Bh7xNe10'], 'Times': [792, 9], 'Number': 54},
                      {'Moves': ['Rh6xBh8', 'Be10-i14'], 'Times': [804, 12], 'Number': 55}, {'Moves': ['Rh8-d8', 'Bi14-j13'], 'Times': [833, 7], 'Number': 56},
                      {'Moves': ['Rd8-h8', 'h10-g10=Q'], 'Times': [853, 6], 'Number': 57}, {'Moves': ['Ne11xQg10', 'Rn10xNg10'], 'Times': [862, 2], 'Number': 58},
                      {'Moves': ['Qf10-d8', 'Rg10-n10'], 'Times': [869, 11], 'Number': 59}, {'Moves': ['Qd8-c9', 'Rn10-n6'], 'Times': [895, 7], 'Number': 60},
                      {'Moves': ['c8-d8', 'Qj12-j6'], 'Times': [906, 4], 'Number': 61}, {'Moves': ['Be7xg9', 'Qj6-a6+'], 'Times': [913, 3], 'Number': 62},
                      {'Moves': ['Ka10-b10', 'Bj13-n9'], 'Times': [919, 8], 'Number': 63}, {'Moves': ['d8-e8', 'Qa6-g6'], 'Times': [930, 7], 'Number': 64},
                      {'Moves': ['e8-f8', 'Bn9-j5'], 'Times': [943, 3], 'Number': 65}, {'Moves': ['d11-e11', 'Bj5-g8'], 'Times': [971, 6], 'Number': 66},
                      {'Moves': ['e11-f11', 'Rn6-n11'], 'Times': [988, 2], 'Number': 67}, {'Moves': ['Bg9-h10', 'm4-k4'], 'Times': [1013, 24], 'Number': 68},
                      {'Moves': ['f11-g11', 'Qg6-f7'], 'Times': [1040, 13], 'Number': 69}, {'Moves': ['Rh8-i8', 'Bg8-h7'], 'Times': [1093, 11], 'Number': 70},
                      {'Moves': ['Ri8-i11', 'Rn11xRi11'], 'Times': [1107, 20], 'Number': 71}, {'Moves': ['Bh10xRi11', 'Bh7-j9'], 'Times': [1129, 6], 'Number': 72},
                      {'Moves': ['Bi11-h10', 'Bj9-l7'], 'Times': [1143, 5], 'Number': 73}, {'Moves': ['Qc9-c8', 'Qf7-g8'], 'Times': [1154, 2], 'Number': 74},
                      {'Moves': ['Qc8-c9', 'k4-j4'], 'Times': [1159, 2], 'Number': 75}, {'Moves': ['Qc9-g9', 'Qg8xQg9'], 'Times': [1163, 31], 'Number': 76},
                      {'Moves': ['Bh10xQg9', 'j4-i4'], 'Times': [1200, 3], 'Number': 77}, {'Moves': ['f8-g8', 'i4xh3'], 'Times': [1205, 6], 'Number': 78},
                      {'Moves': ['Bg9-d6', 'm6-k6'], 'Times': [1217, 13], 'Number': 79}, {'Moves': ['g8-h8=Q'], 'Times': [1232], 'Number': 80}], 'Duration': '1237'}

    return game, sol


def test_filter_data(sample_game_sol):
    f = open("test_game", "x")
    f.write(sample_game_sol[0])
    f.close()
    filtered = filter_data("test_game")
    print(filtered)
    assert type(filtered) == list
    assert len(filtered) == 1
    assert filtered[0] == sample_game_sol[1]
    os.remove("test_game")


def test_data_headers():
    headers = ['GameNr', 'Variant', 'RuleVariants', 'Result', 'Termination', 'Red', 'RedElo', 'Blue', 'BlueElo', 'Yellow', 'YellowElo', 'Green', 'GreenElo', 'TimeControl', 'Site', 'Date', 'Rounds', 'Duration']
    filtered_game = filter_data("test_data_set.txt")
    for game in filtered_game:
        for header in headers:
            assert header in game

